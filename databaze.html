<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Databáze</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<h1>INFO</h1>
<p>By 1T0S_</p>
<p>Úprava textu:</p>
<ul>
    <li>Normální text</li>
    <li class="code">Kód</li>
    <li><i>Názva proměnných, tabulek či databází v kódu</i></li>
    <li><b>Zvýraznění důležitých informací v textu či kódu</b></li>
</ul>

<br>
<h1>Základy databází</h1>
<h2>1. Co jsou to databáze?</h2>
<p>
    Databáze jsou systémy, které se používají k ukládání dat. Databází může být pro příklad accessová tabulka,
    tištěný seznam, excelová tabulka či kniha. Všechny tyto způsoby jsou ovšem neefektivní pro ukládání většího
    množství dat, proto byly vymyšleny Database Management Systémy.
</p>

<h2>2. Database Management System</h2>
<p>
    DBMS je software, který se stará o provádění operací s daty v databázi. Mezi v současnosti nejpoužívanější
    DBMS patří MySQL, PostgreSQL, MongoDB či Oracle.
</p>
<p>
    Operace, které DBMS provádí, se nazývají CRUD.
</p>
<ul>
    <li>Create - Přidávání dat do databáze</li>
    <li>Read - Čtení dat z databáze</li>
    <li>Update - Měnění dat v databázi</li>
    <li>Delete - Mazání dat z databáze</li>
</ul>
<h3>2.1 Databázové enginy</h3>
<p>Databázový engine je část Database Management Systému, která se stará o provádění CRUD operací. Pro DBMS, který
    používáme (MySql), existují dva důležité databázové enginy - InnoDB a MyISAM. Tyto enginy mají několik rozdílů:</p>
<ul>
    <li>MyISAM <b>nepodporuje</b> transakce, InnoDB ano</li>
    <li>MyISAM <b>nepodporuje</b> cizí klíč, InnoDB ano</li>
    <li>InnoDB <b>nepodporuje</b> FULLTEXT, MyISAM ano</li>
</ul>

<h2>3. Druhy databází</h2>
<p>
    Databázové systémy se dělí na dva druhy - relační a nerelační.
</p>
<p>
    Relační databázové systémy ukládají data do tabulek a k provádění CRUD operací používají standardizovaný jazyk SQL.
</p>
<p>
    Nerelační databázové systémy jsou ty, které data do tabulek neukládají = používají jiný způsob ukládání dat.
    Nemají žádný standardizovaný způsob pro provádění CRUD operací, tudíž se liší jak v implementaci, tak práci s nimi.
</p>

<h2>4. Relační databáze</h2>
<p>
    Data v relačních databázích jsou ukládána do tabulek. Jedna databáze má obvykle větší množství tabulek.
</p>
<p>Některé pojmy relačních databází:</p>
<ul>
    <li>Atribut - Sloupec tabulky</li>
    <li>Záznam - Řádek tabulky</li>
    <li>Primární klíč - Unikátní atribut, který jednoznačně označuje záznam v tabulce. Klíč se může skládat z jednoho
        či více sloupců tabulky
    </li>
    <li>Cizí klíč - Atribut, který označuje primární klíč jiné (výjimečně i stejné) tabulky. Jedna tabulka může
        mít více cizích klíčů
    </li>
</ul>

<h2>5. SQL</h2>
<p>
    SQL je zkratka pro Structured Query Language. Používá se pro interakci s DBMS.
    Používá se k:
</p>
<ul>
    <li>Provádění CRUD operací</li>
    <li>Tvoření a správu tabulek a databází</li>
    <li>Administrativním úlohám (export, import, zabezpečení...)</li>
</ul>
<p>
    SQL je standardizovaným jazykem, ovšem ne všechny implementace DBMS tento standard dodržují. Základy implementací
    jsou však zpravidla shodné či velice podobné.
</p>
<h3>5.1. Dotazy</h3>
<p>
    Dotaz (query) je set instrukcí, který se používá pro vykonání určité operace.
</p>

<br>
<h1>Tvorba tabulek, zadávání a manipulace hodnot</h1>
<h2>1. Setup</h2>
<p>
    Pro práci se bude používat XAMPP MySql, konkrétně webový interface localhost/phpmyadmin.
</p>

<h2>2. Datové typy</h2>
<p>
    V databázích se používá velké množství datových typů, zvolení správného datového typu optimalizuje databázi.
    Příklady datových typů:
</p>
<ul>
    <li>INT - Celé číslo</li>
    <li>DECIMAL / FLOAT / DOUBLE - Desetinné číslo</li>
    <li>VARCHAR(VELIKOST) - Řetězec</li>
    <li>BLOB - Velké binární objekty, například obrázky</li>
    <li>DATE - Ukládání data ve formátu yyyy-mm-dd</li>
    <li>TIMESTAMP - Ukládání času ve formátu YYYY-MM-DD HH:MM:SS</li>
</ul>

<h2>3. Tvoření tabulek</h2>
<p>
    Tabulky se dají vytvořit přes grafické rozhraní phpmyadmin či přes SQL.
    Syntaxe SQL dotazu pro vytvoření tabulky:
</p>
<p class="code">
    CREATE TABLE <i>jmeno</i> (<i>jmenoSloupce</i> <b>datovyTyp</b>,
    <i>jmenoSloupce</i> <b>datovyTyp</b> ... );
</p>
<p>
    Příklad, který vytvoří tabulku s int id, string jménem a přijmením:
</p>
<p class="code">
    CREATE TABLE <i>person</i> (
    <i>person_id</i> INT PRIMARY KEY NOT NULL,
    <i>first_name</i> VARCHAR(20),
    <i>last_name</i> VARCHAR(20)
    );
</p>
<p>
    Vytvoří tabulku:
</p>
<table>
    <tr>
        <th>person_id</th>
        <th>first_name</th>
        <th>last_name</th>
    </tr>
</table>
<h3>3.1 Constraints aneb jak se to sakra překládá</h3>
<p>
    Při tvorbě tabulky je možno nastavit chování jednotlivých sloupců, a to například nastavením defaultní hodnoty či
    zakázáním NULL hodnoty. K tomu slouží constraints, které se píší za datový typ sloupce.
</p>
<p>Příklad syntaxe constraints při tvoření tabulky:</p>
<p class="code">
    CREATE TABLE <i>person</i>(
    <i>person_id</i> INT PRIMARY KEY NOT NULL,
    <i>first_name</i> VARCHAR(20) DEFAULT "Damian",
    <i>last_name</i> VARCHAR(20) NOT NULL
    )
</p>
<p>Tato tabulka bude mít int primární klíč, string jméno, které při nezadání hodnoty bude "Damian", a string
    přijmení, které bude nutno zadat, jinak se dotaz neprovede.</p>
<p>List obvykle používaných constraintů:</p>
<ul>
    <li>NOT NULL - Ujistí se, že sloupec má hodnotu, pokud tomu tak není, vyhodí error</li>
    <li>UNIQUE - Ujistí se, že sloupec má unikátní hodnotu (hodnota, která se v něm nachází, není v žádném jiném
        záznamu)
    </li>
    <li>PRIMARY KEY - Primární klíč, woooow!</li>
    <li>DEFAULT <b>val</b> - Pokud není specifikována hodnota sloupce, nastaví ji na <b>val</b></li>
    <li>CHECK <b>(podmínka)</b> - Ujistí se, že zadávaná hodnota splňuje podmínku</li>
    <li>FOREIGN KEY - Reference řádku jiné tabulky</li>
</ul>
<p>Foreign key se zapisuje syntaxí:</p>
<p class="code">...</p>
<p class="code">FOREIGN KEY(<i>jmenoSloupce</i>) REFERENCES <i>jmenoCiziTabulky</i>(<i>jmenoSloupceVCiziTabulce</i>);
</p>
<p class="code">...</p>

<h2>4. Mazání tabulek</h2>
<p>
    Tabulky se dají smazat pomocí snadného příkazu:
</p>
<p class="code">
    DROP TABLE <i>jmenoTabulky</i>;
</p>

<h2>5. Modifikace tabulek</h2>
<p>
    Již existující tabulky lze modifikovat, například přidáním či odebráním sloupce nebo změnou datového typu sloupce.
</p>
<p class="code">ALTER TABLE <i>jmenoTabulky</i> ADD <i>jmenoSloupce</i> <b>datovyTyp</b></p>
<p class="code">ALTER TABLE <i>jmenoTabulky</i> DROP COLUMN <i>jmenoSloupce</i></p>
<p class="code">ALTER TABLE <i>jmenoTabulky</i> ALTER COLUMN <i>jmenoSloupce</i> <b>datovyTyp</b></p>

<h2>6. Přidávání dat do tabulky</h2>
<p>
    Po vytvoření tabulky je potřeba ji naplnit daty. To se obvykle nedělá manuálně, ale za pomocí skriptu či programu.
    Syntaxe sql dotazu pro přidání záznamu do tabulky:
</p>
<p class="code">INSERT INTO <i>jmenoTabulky</i> VALUES(<b>hodnoty</b>);</p>
<p>Příklad, který přidá člověka Pepe Gun s id 0:</p>
<p class="code">
    INSERT INTO <i>person</i> VALUES(0, "Pepe", "Gun");
</p>
<p>Příklad, který přidá člověka Damian s id 1. Příjmení je neznámé, tudíž NULL</p>
<p class="code">
    INSERT INTO <i>person</i>(id, first_name) VALUES (1, "Damian");
</p>

<h2>7. Měnění dat v tabulce</h2>
<h3>7.1. Měnění dat</h3>
<p>Data v tabulce se dají měnit pomocí webového rozhraní phpmyadmin či SQL.</p>
<p>Pro měnění dat se používá příkaz UPDATE:</p>
<p class="code">
    UPDATE <i>jmenoTabulky</i> SET <i>jmenoAtributu</i> = <b>hodnota</b> WHERE <b>podminka</b>;
</p>
<p>Příklad, který změní všechny lidi, kteří se jmenují "Pepa", na "Damián"</p>
<p class="code">
    UPDATE <i>person</i> SET <i>first_name</i> = "Damian" WHERE <i>first_name</i> = "Pepa";
</p>
<h3>7.2. Mazání záznamů</h3>
<p>Na podobném principu funguje příkaz na mazání řádků tabulky:</p>
<p class="code">
    DELETE FROM <i>jmenoTabulky</i> WHERE <b>podminka</b>;
</p>
<p>Příklad, který smaže všechny, kteří se jmenují Damian</p>
<p class="code">
    DELETE FROM <i>person</i> WHERE <i>first_name</i> = "Damian";
</p>

<br>
<h1>Získávání dat z databáze</h1>

<h2>1. Dotazy</h2>
<p>
    Dotazy (queries) jsou způsobem, jak z databáze dostat data. Pro tvorbu dotazů, které tahají data z databáze,
    se používá příkaz SELECT
</p>
<p>Základní tvar příkazu SELECT, který vybere veškeré záznamy z dané tabulky:</p>
<p class="code">SELECT * FROM <i>jmenoTabulky</i>;</p>
<p>Hvězdička může být vyměněna za konkrétní sloupce, které chceme dotazem získat.</p>
<p>Příklad dotazu, který vybere jména a přijmení z tabulky person:</p>
<p class="code">SELECT <i>name</i>, <i>surname</i> FROM <i>person</i>;</p>

<h2>2. Třízení</h2>
<p>Výsledky, které dotaz vrátí, je možno třídit pomocí ORDER BY:</p>
<p class="code">SELECT * FROM <i>jmenoDatabaze</i> ORDER BY <i>jmenoSloupce</i>, <i>jmenoSloupce, ...</i>;</p>
<p>
    Třídit lze dle většiny datových typů. V základu jsou data třízena vzestupně (0...∞, A...Z), přidáním keywordu
    <b>DESC</b> za název sloupce však lze třídit i sestupně.
</p>
<p>Příklad, který vybere jména a věk z databáze a tato data následně setřídí sestupně:</p>
<p class="code">SELECT <i>name</i>, <i>age</i> FROM <i>person</i> ORDER BY <i>age</i> DESC, <i>name</i> DESC;</p>

<h2>3. Limitování</h2>
<p>Počet výsledků, které dotaz zobrazí, je možno omezit příkazem <b>LIMIT</b>:</p>
<p class="code">SELECT * FROM <i>databaze</i> LIMIT <i>n</i>;</p>
<p>Tento příkaz vypíše pouze <i>n</i> prvků z <i>tabulky</i></p>

<h2>4. Podmínky</h2>
<p>
    Vracet všechny záznamy tabulky nemá smysl, proto jsou tu podmínky. Pomocí příkazu <b>WHERE</b> lze omezit, jaké
    sloupce budou vráceny.
</p>
<p>Vzorový tvar dotazu s WHERE:</p>
<p class="code">SELECT * FROM <i>tabulka</i> WHERE <b>podminka</b>;</p>
<p>Podmínek může být více, spojují se pak logickými operátory:</p>
<p class="code">SELECT * FROM <i>tabulka</i> WHERE <b>podminka</b> <i>logickyOperator</i>
    <b>podminka</b> <i>logickyOperator</i> <b>podminka</b>....;</p>
<p>List často používaných operátorů:</p>
<ul>
    <li><b> >, <, <=, >=, =, <> </b> Operátory porovnání</li>
    <li><b>AND, OR</b> Základní logické operátory</li>
    <li><b>IN, BETWEEN, LIKE</b> Používány pro složitější podmínky</li>
</ul>
<p>Příklady:</p>
<p class="code">SELECT * FROM <i>person</i> WHERE <i>age</i> BETWEEN 20 AND 80</p>
<p class="code">SELECT * FROM <i>person</i> WHERE <i>surname</i> IN ("Net", "Bruh")</p>
<p class="code">SELECT * FROM <i>person</i> WHERE <i>name</i> LIKE "M%a"</p>
<p>(Protože je to docela mess, třetí query vrátí řádky, kde jméno začíná na <b>M</b> a končí na <b>a</b></p>

<h2>5. Funkce</h2>
<p>
    Místo záznamů z tabulky může dotaz vracet i jiné hodnoty, například průměr daného sloupce.
    K tomu se využívají SQL funkce.
</p>
<p>
    Funkce fungují stejně jako výběrové dotazy, akorát je místo sloupců, které chceme vybrat, zadána funkce.
</p>
<p>Obecný tvar:</p>
<p class="code">SELECT <i>FUNKCE(<b>parametry</b>)</i> FROM <i>tabulka</i>;</p>
<p>Příklad, který vypíše průměrný věk lidí v tabulce:</p>
<p class="code">SELECT AVG(<i>age</i>) FROM <i>person</i>;</p>
<h3>5.1. Často používané funkce</h3>
<ul>
    <li><b>COUNT(*)</b> - Vypíše počet záznamů ve sloupci</li>
    <li><b>SUM(*)</b> - Součet hodnot ve sloupci</li>
    <li><b>AVG(*)</b> - Průměr hodnot ve sloupci</li>
    <li><b>MAX(*)</b> - Nejvyšší hodnota ve sloupci</li>
    <li><b>MIN(*)</b> - Nejnižší hodnota ve sloupci</li>
</ul>
<p>(Za hvězdičku lze doplnit název jakéhokoli sloupce)</p>

<h2>6. Agregace</h2>
<p><b>Tohle je mess, nejsem si tím jistý</b></p>
<p>Agregace jsou dotazy, které kombinují funkce a výpis jednotlivých řádků.</p>
<p>Obecný tvar agregace:</p>
<p class="code">SELECT <b>FUNKCE(<i>sloupec</i>)</b>, <i>sloupec</i> FROM <i>jmenoTabulky</i> GROUP BY <i>sloupec</i>;
</p>
<br>
<p>Příklad, který vypíše, kolik jednotliví lidé vydělali:</p>
<p class="code">SELECT <i>name</i>, <b>SUM(<i>price</i>)</b> FROM <i>stonks</i> GROUP BY <i>name</i>;</p>
<p>Tento příklad poskytne výpis:</p>
<table>
    <tr>
        <th>name</th>
        <th>SUM(price)</th>
    </tr>
    <tr>
        <td>Damian</td>
        <td>420000</td>
    </tr>
    <tr>
        <td>Pepa</td>
        <td>50000</td>
    </tr>
    <tr>
        <td>Arnošt</td>
        <td>666666</td>
    </tr>
</table>
</body>
</html>